<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Bookshop - Home</title>
  <link rel="stylesheet" href="../css/styles.css">
</head>
<body>
  <h1>Welcome to Bookshop</h1>
  <button onclick="logout()">Logout</button>
  <a href="cart.html">Go to Cart</a>

  <div id="book-list"></div>

  <script>
    const token = localStorage.getItem('token');
    if (!token) window.location.href = 'login.html';

    fetch('http://localhost:5000/api/books', {
      headers: { Authorization: `Bearer ${token}` }
    })
    .then(res => res.json())
    .then(books => {
      const container = document.getElementById('book-list');
      books.forEach(book => {
        const div = document.createElement('div');
        div.innerHTML = `
          <h3>${book.title}</h3>
          <p>${book.author}</p>
          <p>$${book.price}</p>
          <button onclick="addToCart(${book.id})">Add to Cart</button>
        `;
        container.appendChild(div);
      });
    });

    function addToCart(bookId) {
      fetch('http://localhost:5000/api/cart/add', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          Authorization: `Bearer ${token}`
        },
        body: JSON.stringify({ bookId })
      })
      .then(res => res.json())
      .then(data => alert(data.message));
    }

    function logout() {
      localStorage.removeItem('token');
      window.location.href = 'login.html';
    }
  </script>
</body>
</html>
